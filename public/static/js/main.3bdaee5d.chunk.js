(this.webpackJsonpadmin=this.webpackJsonpadmin||[]).push([[0],{290:function(e,t,n){},292:function(e,t,n){},398:function(e,t,n){},399:function(e,t,n){},400:function(e,t,n){},401:function(e,t,n){},502:function(e,t,n){},508:function(e,t,n){},509:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),s=n(42),c=n.n(s),i=n(21),o=n(22),u=n(24),l=n(23),d=n(72),h=n(39),p=(n(290),n(17)),j=n.n(p),m=n(30),b=n(281),f=n(520),O=n(279),x=n(45),g=n(524),y=n(525),v=(n(292),n.p+"static/media/logo.f6487143.png"),k=n(155),w=n(199),C=n.n(w);function S(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"GET";return new Promise((function(a,r){("GET"===n?C.a.get(e,{params:t}):C.a.post(e,t)).then((function(e){a(e.data)})).catch((function(e){b.b.error("\u8bf7\u6c42\u51fa\u9519"+e.message)}))}))}var N=n(270),I=n.n(N),P=function(e,t){return S("/login",{username:e,password:t},"POST")},F=function(e){return S("/manage/category/list",{parentId:e})},A=function(e,t){return S("/manage/category/add",{parentId:e,categoryName:t},"POST")},T=function(e,t){return S("/manage/category/Update",{categoryId:e,categoryName:t},"POST")},_=function(e,t){return S("/manage/product/list",{pageNum:e,pageSize:t})},U=function(e,t,n,a){return S("/manage/product/search",Object(k.a)({pageNum:e,pageSize:t},a,n))},R=function(e){return S("/manage/category/info",{categoryId:e})},M=function(e,t){return S("/manage/product/updateStatus",{productId:e,status:t},"POST")},D=function(e){return S("/manage/img/delete",{name:e},"POST")},E=function(e,t,n,a,r,s,c){return S("/manage/product/add",{pCategoryId:e,categoryId:t,name:n,desc:a,price:r,detail:s,imgs:c},"POST")},L=function(e,t,n,a,r,s,c,i){return S("/manage/product/update",{_id:e,pCategoryId:t,categoryId:n,name:a,desc:r,price:s,detail:c,imgs:i},"POST")},V=function(e){return S("/manage/role/add",{roleName:e},"POST")},B=function(e){return S("/manage/role/update",e,"POST")},K=function(e){return S("/manage/user/add",e,"POST")},z=function(e){return S("/manage/user/update",e,"POST")},W=function(e){return new Promise((function(t){var n="https://restapi.amap.com/v3/weather/weatherInfo?city=".concat({"\u5317\u4eac":11e4,"\u4e0a\u6d77":31e4,"\u676d\u5dde":330100}[e],"&key=5348e4e333c889a1903e48244f69ea73");I()(n,{},(function(e,n){if(e||"1"!==n.status)b.b.error("\u8bf7\u6c42\u5931\u8d25");else{var a=n.lives[0],r=a.city,s=a.weather,c=a.reporttime;t({city:r,weather:s,reporttime:c})}}))}))},q={user:{}},H=n(183),J=n.n(H),G={saveUser:function(e){J.a.set("user_key",e)},getUser:function(){return J.a.get("user_key")},removeUser:function(){J.a.remove("user_key")}},Q=n(5),Z=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(i.a)(this,n);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).onFinish=function(){var t=Object(m.a)(j.a.mark((function t(n){var a,r,s;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=n.username,r=n.password,t.next=3,P(a,r);case 3:s=t.sent,console.log(s),0===s.status?(b.b.success("\u767b\u9646\u6210\u529f"),q.user=s.data,G.saveUser(s.data),e.props.history.push("/")):b.b.error(s.msg);case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.onFinishFailed=function(e){console.log("failed",e)},e}return Object(o.a)(n,[{key:"render",value:function(){var e=q.user;return e&&e._id?Object(Q.jsx)(h.a,{to:"/"}):Object(Q.jsxs)("div",{className:"login",children:[Object(Q.jsxs)("header",{className:"login-header",children:[Object(Q.jsx)("img",{src:v,alt:"logo"}),Object(Q.jsx)("h1",{children:"React\u9879\u76ee \u540e\u53f0\u7ba1\u7406\u7cfb\u7edf"})]}),Object(Q.jsxs)("section",{className:"login-content",children:[Object(Q.jsx)("h2",{children:"\u7528\u6237\u767b\u5f55"}),Object(Q.jsx)("div",{children:Object(Q.jsxs)(f.a,{name:"basic",wrapperCol:{span:100},className:"login-form",onFinish:this.onFinish,onFinishFailed:this.onFinishFailed,children:[Object(Q.jsx)(f.a.Item,{name:"username",rules:[{whitespace:!0,message:"Please input your username!"},{required:!0,message:"Please input your username!"},{min:4,message:"\u7528\u6237\u540d\u81f3\u5c114\u4f4d"},{max:12,message:"\u7528\u6237\u540d\u6700\u591a12\u4f4d"},{pattern:/^[a-zA-Z0-9_]+$/,message:"\u7528\u6237\u540d\u5fc5\u987b\u7531\u5b57\u6bcd\u6570\u5b57\u4e0b\u5212\u7ebf\u7ec4\u6210"}],initialValue:"admin",children:Object(Q.jsx)(O.a,{placeholder:"\u7528\u6237\u540d",prefix:Object(Q.jsx)(g.a,{style:{color:"rgba(0,0,0,.25)"}})})}),Object(Q.jsx)(f.a.Item,{name:"password",rules:[{whitespace:!0,message:"Please input your password!"},{required:!0,message:"Please input your password!"},{min:4,message:"\u5bc6\u7801\u81f3\u5c114\u4f4d"},{max:12,message:"\u5bc6\u7801\u6700\u591a12\u4f4d"},{pattern:/^[a-zA-Z0-9_]+$/,message:"\u7528\u6237\u540d\u5fc5\u987b\u7531\u5b57\u6bcd\u6570\u5b57\u4e0b\u5212\u7ebf\u7ec4\u6210"}],children:Object(Q.jsx)(O.a.Password,{placeholder:"\u5bc6\u7801",prefix:Object(Q.jsx)(y.a,{style:{color:"rgba(0,0,0,.25)"}})})}),Object(Q.jsx)(f.a.Item,{children:Object(Q.jsx)(x.a,{type:"primary",htmlType:"submit",className:"login-form-button",children:"\u767b\u5f55"})})]})})]})]})}}]),n}(a.Component),$=n(515),X=n(521),Y=n(526);n(398);function ee(e){if(!e)return"";var t=new Date(e);return t.getFullYear()+"-"+(t.getMonth()+1)+"-"+t.getDate()+" "+t.getHours()+":"+t.getMinutes()+":"+t.getSeconds()}var te=[{title:"\u9996\u9875",key:"/home",icon:"home",isPublic:!0},{title:"\u5546\u54c1",key:"/products",icon:"appstore",children:[{title:"\u54c1\u7c7b\u7ba1\u7406",key:"/category",icon:"bars"},{title:"\u5546\u54c1\u7ba1\u7406",key:"/product",icon:"tool"}]},{title:"\u7528\u6237\u7ba1\u7406",key:"/user",icon:"user"},{title:"\u89d2\u8272\u7ba1\u7406",key:"/role",icon:"safety"},{title:"\u56fe\u5f62\u56fe\u8868",key:"/charts",icon:"area-chart",children:[{title:"\u67f1\u5f62\u56fe",key:"/charts/bar",icon:"bar-chart"},{title:"\u6298\u7ebf\u56fe",key:"/charts/line",icon:"line-chart"},{title:"\u997c\u56fe",key:"/charts/pie",icon:"pie-chart"}]}],ne=n(94),ae=(n(399),function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"render",value:function(){return Object(Q.jsx)("button",Object(ne.a)(Object(ne.a)({},this.props),{},{className:"link-button"}))}}]),n}(a.Component)),re=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(i.a)(this,n);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).state={city:"\u5317\u4eac",weather:"\u6674",currentTime:ee(Date.now())},e.getWeather=Object(m.a)(j.a.mark((function t(){var n,a,r;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,W("\u5317\u4eac");case 2:n=t.sent,a=n.weather,r=n.city,e.setState({weather:a,city:r});case 6:case"end":return t.stop()}}),t)}))),e.getTime=function(){e.intervalId=setInterval((function(){var t=ee(Date.now());e.setState({currentTime:t})}),1e3)},e.getTitle=function(t){var n,a=e.props.location.pathname;return t.forEach((function(e){if(e.children){var t=e.children.find((function(e){return 0===a.indexOf(e.key)}));if(t)return void(n=t.title)}else if(0===a.indexOf(e.key))return void(n=e.title)})),n},e.confirm=function(){X.a.confirm({title:"Confirm",icon:Object(Q.jsx)(Y.a,{}),content:"\u4f60\u786e\u5b9a\u8981\u9000\u51fa\u767b\u5f55\u5417\uff1f",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",onOk:function(){G.removeUser(),q.user={},e.props.history.replace("/login")}})},e}return Object(o.a)(n,[{key:"componentDidMount",value:function(){this.getWeather(),this.getTime()}},{key:"componentWillUnmount",value:function(){clearInterval(this.intervalId)}},{key:"render",value:function(){var e=this.getTitle(te),t=this.state,n=t.weather,a=t.currentTime,r=t.city;return Object(Q.jsxs)("div",{className:"header",children:[Object(Q.jsxs)("div",{className:"header-top",children:[Object(Q.jsxs)("span",{children:["\u6b22\u8fce,",q.user.username]}),Object(Q.jsx)(ae,{onClick:this.confirm,children:"\u9000\u51fa"})]}),Object(Q.jsxs)("div",{className:"header-bottom",children:[Object(Q.jsx)("div",{className:"header-bottom-left",children:e}),Object(Q.jsxs)("div",{className:"header-bottom-right",children:[Object(Q.jsx)("span",{className:"span-time",children:a}),Object(Q.jsx)("span",{className:"span-city",children:r}),Object(Q.jsx)("span",{className:"span-weather",children:n})]})]})]})}}]),n}(a.Component),se=Object(h.g)(re),ce=n(107),ie=n(527),oe=n(528),ue=(n(400),function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(i.a)(this,n);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).getMenuNodes=function(t){var n=ce.a.SubMenu;return t.map((function(t){return t.children?Object(Q.jsx)(n,{icon:Object(Q.jsx)(oe.a,{}),title:t.title,children:e.getMenuNodes(t.children)},t.key):Object(Q.jsx)(ce.a.Item,{icon:Object(Q.jsx)(ie.a,{}),children:Object(Q.jsx)(d.b,{to:t.key,children:t.title})},t.key)}))},e.hasAuth=function(e){var t=e.key,n=e.isPublic,a=q.user.role.menus;return!("admin"!==q.user.username&&!n&&-1===a.indexOf(t))||!!e.children&&!!e.children.find((function(e){return-1!==a.indexOf(e.key)}))},e.getMenuNodesReduce=function(t){var n=e.props.location.pathname,a=ce.a.SubMenu;return t.reduce((function(t,r){e.hasAuth(r)&&(r.children?(r.children.find((function(e){return 0===n.indexOf(e.key)}))&&(e.openkey=r.key),t.push(Object(Q.jsx)(a,{icon:Object(Q.jsx)(oe.a,{}),title:r.title,children:e.getMenuNodesReduce(r.children)},r.key))):t.push(Object(Q.jsx)(ce.a.Item,{icon:Object(Q.jsx)(ie.a,{}),children:Object(Q.jsx)(d.b,{to:r.key,children:r.title})},r.key)));return t}),[])},e}return Object(o.a)(n,[{key:"UNSAFE_componentWillMount",value:function(){this.getMenuNodesReduce(te)}},{key:"render",value:function(){var e=this.props.location.pathname;return 0===e.indexOf("/product")&&(e="/product"),Object(Q.jsxs)("div",{className:"left-nav",children:[Object(Q.jsxs)(d.b,{className:"left-nav-header",to:"/",children:[Object(Q.jsx)("img",{src:v,alt:""}),Object(Q.jsx)("h2",{children:"\u540e\u53f0\u7cfb\u7edf"})]}),Object(Q.jsx)("div",{className:"left-nav-list",children:Object(Q.jsx)(ce.a,{mode:"inline",theme:"dark",selectedKeys:[e],defaultOpenKeys:[this.openkey],children:this.getMenuNodesReduce(te)})})]})}}]),n}(a.Component)),le=Object(h.g)(ue),de=(n(401),function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"render",value:function(){return Object(Q.jsx)("div",{className:"home",children:"\u6b22\u8fce\u6765\u5230\u540e\u53f0\u7cfb\u7edf"})}}]),n}(a.Component)),he=n(518),pe=n(516),je=n(529),me=n(530),be=n(136),fe=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"componentDidMount",value:function(){this.props.setForm(this.form)}},{key:"render",value:function(){var e=this,t=this.props,n=t.categorys,a=t.parentId;return this.form&&this.form.setFieldsValue({parentId:a}),Object(Q.jsxs)(f.a,{ref:function(t){return e.form=t},children:[Object(Q.jsx)(f.a.Item,{initialValue:a,name:"parentId",children:Object(Q.jsxs)(be.a,{children:[Object(Q.jsx)(be.a.Option,{value:"0",children:"\u4e00\u7ea7\u5206\u7c7b"}),n.map((function(e){return Object(Q.jsx)(be.a.Option,{value:e._id,children:e.name},e._id)}))]})}),Object(Q.jsx)(f.a.Item,{initialValue:"",name:"categoryName",rules:[{required:!0,whitespace:!0,message:"\u540d\u79f0\u4e0d\u80fd\u4e3a\u7a7a"}],children:Object(Q.jsx)(O.a,{placeholder:"\u8bf7\u8f93\u5165\u5206\u7c7b\u540d\u79f0"})})]})}}]),n}(a.Component),Oe=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"componentDidMount",value:function(){console.log("updateform@"),this.props.setForm(this.form)}},{key:"render",value:function(){var e=this;return this.form&&this.form.setFieldsValue({note:this.props.categoryName}),Object(Q.jsx)(f.a,{ref:function(t){e.form=t},children:Object(Q.jsx)(f.a.Item,{initialValue:this.props.categoryName,name:"note",rules:[{required:!0,whitespace:!0,message:"\u540d\u79f0\u4e0d\u80fd\u4e3a\u7a7a"}],children:Object(Q.jsx)(O.a,{placeholder:"\u8bf7\u8f93\u5165\u5206\u7c7b\u540d\u79f0"})})})}}]),n}(a.Component),xe=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(i.a)(this,n);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).state={parentId:"0",parentName:"",categorys:[],subCategorys:[],loading:!1,showStatus:0},e.getCategorys=function(){var t=Object(m.a)(j.a.mark((function t(n){var a;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.setState({loading:!0}),n=n||e.state.parentId,t.next=4,F(n);case 4:0===(a=t.sent).status?"0"===n?e.setState({categorys:a.data,loading:!1}):e.setState({subCategorys:a.data,loading:!1}):b.b.error("\u8bf7\u6c42\u5546\u54c1\u5931\u8d25");case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.getSubCategorys=function(t){e.setState({parentId:t._id,parentName:t.name},(function(){e.getCategorys()}))},e.firstList=function(){e.setState({parentId:"0",parentName:"",subCategorys:[]})},e.showAdd=function(){e.setState({showStatus:1})},e.showUpdate=function(t){e.category=t,e.setState({showStatus:2})},e.handleCancel=function(){e.setState({showStatus:0}),e.form&&e.form.resetFields(),e.addForm&&e.addForm.resetFields()},e.addCategory=Object(m.a)(j.a.mark((function t(){return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.addForm.validateFields().then(function(){var t=Object(m.a)(j.a.mark((function t(n){var a,r;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=n.parentId,r=n.categoryName,t.next=4,A(a,r);case 4:0===t.sent.status&&(a===e.state.parentId?e.getCategorys():"0"===a&&e.getCategorys("0")),e.addForm.resetFields(),e.setState({showStatus:0});case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 1:case"end":return t.stop()}}),t)}))),e.updateCategory=Object(m.a)(j.a.mark((function t(){return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.form.validateFields().then(function(){var t=Object(m.a)(j.a.mark((function t(n){var a,r;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.category._id,r=n.note,t.next=4,T(a,r);case 4:0===t.sent.status&&e.getCategorys(),e.setState({showStatus:0});case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 1:case"end":return t.stop()}}),t)}))),e.initColumns=function(){e.columns=[{title:"\u59d3\u540d",dataIndex:"name",key:"name"},{title:"\u64cd\u4f5c",width:"30%",render:function(t){return Object(Q.jsxs)("span",{children:[Object(Q.jsx)(ae,{onClick:function(){return e.showUpdate(t)},children:"\u4fee\u6539\u5206\u7c7b"}),"0"===e.state.parentId?Object(Q.jsx)(ae,{onClick:function(){return e.getSubCategorys(t)},children:"\u67e5\u770b\u5b50\u5206\u7c7b"}):""]})}}]},e}return Object(o.a)(n,[{key:"componentDidMount",value:function(){this.initColumns(),this.getCategorys()}},{key:"render",value:function(){var e=this,t=this.state,n=t.categorys,a=t.subCategorys,r=t.parentId,s=t.loading,c=t.parentName,i=t.showStatus;this.category=this.category||{};var o="0"===r?"\u4e00\u7ea7\u5206\u7c7b\u5217\u8868":Object(Q.jsxs)("span",{children:[Object(Q.jsx)(ae,{onClick:this.firstList,children:"\u4e00\u7ea7\u5206\u7c7b\u5217\u8868"}),Object(Q.jsx)(je.a,{}),"\xa0",Object(Q.jsx)("span",{children:c})]}),u=Object(Q.jsxs)(x.a,{type:"primary",onClick:this.showAdd,children:[Object(Q.jsx)(me.a,{}),"\u6dfb\u52a0"]});return Object(Q.jsxs)(he.a,{title:o,extra:u,children:[Object(Q.jsx)(pe.a,{bordered:!0,rowKey:"_id",dataSource:"0"===r?n:a,columns:this.columns,loading:s,pagination:{defaultPageSize:5,showQuickJumper:!0}}),Object(Q.jsx)(X.a,{title:"\u6dfb\u52a0\u5206\u7c7b",visible:1===i,onOk:this.addCategory,onCancel:this.handleCancel,children:Object(Q.jsx)(fe,{setForm:function(t){return e.addForm=t},categorys:n,parentId:r})}),Object(Q.jsx)(X.a,{title:"\u66f4\u65b0\u5206\u7c7b",visible:2===i,onOk:this.updateCategory,onCancel:this.handleCancel,children:Object(Q.jsx)(Oe,{categoryName:this.category.name,setForm:function(t){e.form=t}})})]})}}]),n}(a.Component),ge=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(i.a)(this,n);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).state={total:0,products:[],loading:!1,searchName:"",searchType:"productName",currentPageNum:1},e.getProductStatus=function(){},e.initColumns=function(){e.columns=[{title:"\u5546\u54c1\u540d\u79f0",dataIndex:"name",key:"name"},{title:"\u5546\u54c1\u63cf\u8ff0",dataIndex:"desc",key:"desc"},{title:"\u4ef7\u683c",dataIndex:"price",key:"price",render:function(e){return"\uffe5"+e}},{title:"\u72b6\u6001",key:"status",render:function(t){var n=t.status,a=t._id;return Object(Q.jsxs)("span",{children:[Object(Q.jsx)(x.a,{type:"primary",onClick:e.changeProductStatus(a,1===n?2:1),children:1===n?"\u4e0b\u67b6":"\u4e0a\u67b6"}),Object(Q.jsx)("br",{}),Object(Q.jsx)("span",{children:1===n?"\u5728\u552e":"\u5df2\u4e0b\u67b6"})]})}},{title:"\u64cd\u4f5c",key:"address",render:function(t){var n=e.state,a=n.currentPageNum,r=n.searchName,s=n.searchType;return Object(Q.jsxs)("span",{children:[Object(Q.jsx)(ae,{onClick:function(){return e.props.history.push("/product/detail",{product:t})},children:"\u8be6\u60c5"}),Object(Q.jsx)(ae,{onClick:function(){return e.props.history.push("/product/addupdate",{product:t,currentPageNum:a,searchName:r,searchType:s})},children:"\u4fee\u6539"})]})}}]},e.changeProductStatus=function(t,n){return Object(m.a)(j.a.mark((function a(){var r,s,c;return j.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,M(t,n);case 2:0===a.sent.status&&(r=e.state,s=r.searchName,c=r.currentPageNum,s?e.searchProducts(c):e.getProducts(c),b.b.success("\u5546\u54c1\u66f4\u65b0\u6210\u529f"));case 4:case"end":return a.stop()}}),a)})))},e.getProducts=function(){var t=Object(m.a)(j.a.mark((function t(n){var a,r,s,c;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.setState({loading:!0}),t.next=3,_(n,3);case 3:0===(a=t.sent).status&&(r=a.data,s=r.total,c=r.list,e.setState({total:s,products:c,loading:!1,currentPageNum:n}));case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.searchProducts=function(){var t=Object(m.a)(j.a.mark((function t(n,a,r,s){var c,i,o,u,l,d;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.setState({loading:!0}),c=r||e.state.searchName,i=s||e.state.searchType,t.next=5,U(n,3,c,i);case 5:0===(o=t.sent).status&&(u=o.data,l=u.total,d=u.list,e.setState({total:l,products:d,loading:!1,currentPageNum:n,searchName:c,searchType:i}));case 7:case"end":return t.stop()}}),t)})));return function(e,n,a,r){return t.apply(this,arguments)}}(),e}return Object(o.a)(n,[{key:"UNSAFE_componentWillMount",value:function(){this.initColumns()}},{key:"componentDidMount",value:function(){if(this.props.location.state){var e=this.props.location.state,t=e.currentPageNum,n=e.searchName,a=e.searchType,r=e.total;n&&t?this.searchProducts(t,"",n,a):t?this.getProducts(t):this.getProducts(parseInt((r+1)/3)+1)}else this.getProducts(1)}},{key:"render",value:function(){var e=this,t=be.a.Option,n=this.state,a=n.products,r=n.total,s=n.loading,c=n.searchType,i=n.searchName,o=Object(Q.jsxs)("span",{children:[Object(Q.jsxs)(be.a,{value:c,onChange:function(t){return e.setState({searchType:t})},children:[Object(Q.jsx)(t,{value:"productName",children:"\u6309\u540d\u79f0\u641c\u7d22"}),Object(Q.jsx)(t,{value:"productDesc",children:"\u6309\u63cf\u8ff0\u641c\u7d22"})]}),Object(Q.jsx)(O.a,{placeholder:"\u5173\u952e\u5b57",style:{width:150,margin:"0 15px"},onChange:function(t){e.setState({searchName:t.target.value})}}),Object(Q.jsx)(x.a,{type:"primary",onClick:function(){return e.searchProducts(1)},children:"\u641c\u7d22"})]}),u=Object(Q.jsxs)(x.a,{type:"primary",onClick:function(){return e.props.history.push("/product/addupdate",{total:r})},children:[Object(Q.jsx)(me.a,{}),"\u6dfb\u52a0"]});return Object(Q.jsx)(he.a,{title:o,extra:u,style:{width:"100%"},children:Object(Q.jsx)(pe.a,{dataSource:a,columns:this.columns,bordered:!0,rowKey:"_id",loading:s,pagination:{defaultPageSize:3,total:r,showQuickJumper:!0,onChange:i?this.searchProducts:this.getProducts,current:this.state.currentPageNum}})})}}]),n}(a.Component),ye=n(523),ve=n(531),ke=n(285),we=ye.b.Item,Ce=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(i.a)(this,n);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).state={categoryName1:"",categoryName2:""},e}return Object(o.a)(n,[{key:"componentWillMount",value:function(){var e=Object(m.a)(j.a.mark((function e(){var t,n,a,r,s;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.props.location.state.product,n=t.pCategoryId,a=t.categoryId,"0"!==n){e.next=8;break}return e.next=4,R(a);case 4:0===(r=e.sent).status&&this.setState({categoryName1:r.data.name}),e.next=12;break;case 8:return e.next=10,Promise.all([R(n),R(a)]);case 10:0!==(s=e.sent)[0].status&&0!==s[1].status||this.setState({categoryName1:s[0].data.name,categoryName2:s[1].data.name});case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=this.props.location.state.product,n=t.name,a=t.desc,r=t.price,s=t.imgs,c=t.detail,i=this.state,o=i.categoryName1,u=i.categoryName2,l=Object(Q.jsxs)("span",{children:[Object(Q.jsx)(ae,{onClick:function(){return e.props.history.goBack()},children:Object(Q.jsx)(ve.a,{style:{color:"#1DA57A",fontSize:20}})}),"\xa0",Object(Q.jsx)("span",{children:"\u5546\u54c1\u8be6\u60c5"})]});return Object(Q.jsx)(he.a,{title:l,className:"product-detail",children:Object(Q.jsxs)(ye.b,{bordered:!0,children:[Object(Q.jsxs)(we,{className:"item",children:[Object(Q.jsx)("span",{className:"left",children:"\u5546\u54c1\u540d\u79f0:"}),Object(Q.jsx)("span",{className:"right",children:n})]}),Object(Q.jsxs)(we,{className:"item",children:[Object(Q.jsx)("span",{className:"left",children:"\u5546\u54c1\u63cf\u8ff0:"}),Object(Q.jsx)("span",{className:"right",children:a})]}),Object(Q.jsxs)(we,{className:"item",children:[Object(Q.jsx)("span",{className:"left",children:"\u5546\u54c1\u4ef7\u683c:"}),Object(Q.jsx)("span",{className:"right",children:r})]}),Object(Q.jsxs)(we,{className:"item",children:[Object(Q.jsx)("span",{className:"left",children:"\u6240\u5c5e\u5206\u7c7b:"}),Object(Q.jsxs)("span",{className:"right",children:[o,u?"--\x3e"+u:""]})]}),Object(Q.jsxs)(we,{className:"item",children:[Object(Q.jsx)("span",{className:"left",children:"\u5546\u54c1\u56fe\u7247:"}),Object(Q.jsx)("span",{className:"right",children:s.map((function(e){return Object(Q.jsx)("img",{className:"product-img",src:"http://localhost:5000/upload/"+e,alt:""},Object(ke.a)())}))})]}),Object(Q.jsxs)(we,{className:"item",children:[Object(Q.jsx)("span",{className:"left",children:"\u5546\u54c1\u8be6\u60c5:"}),Object(Q.jsx)("span",{className:"right",dangerouslySetInnerHTML:{__html:c}})]})]})})}}]),n}(a.Component),Se=n(173),Ne=n(154),Ie=n(522),Pe=n(517);function Fe(e){return new Promise((function(t,n){var a=new FileReader;a.readAsDataURL(e),a.onload=function(){return t(a.result)},a.onerror=function(e){return n(e)}}))}var Ae=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(e){var a;Object(i.a)(this,n),(a=t.call(this,e)).handleCancel=function(){return a.setState({previewVisible:!1})},a.handlePreview=function(){var e=Object(m.a)(j.a.mark((function e(t){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.url||t.preview){e.next=4;break}return e.next=3,Fe(t.originFileObj);case 3:t.preview=e.sent;case 4:a.setState({previewImage:t.url||t.preview,previewVisible:!0});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.handleChange=function(){var e=Object(m.a)(j.a.mark((function e(t){var n,r,s,c,i,o;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.file,r=t.fileList,"done"!==n.status){e.next=6;break}0===(s=n.response).status?(b.b.success("\u4e0a\u4f20\u56fe\u7247\u6210\u529f"),c=s.data,i=c.name,o=c.url,n.name=i,n.url=o):b.b.error("\u4e0a\u4f20\u56fe\u7247\u5931\u8d25"),e.next=12;break;case 6:if("removed"!==n.status){e.next=12;break}return console.log(n.name),e.next=10,D(n.name);case 10:0===e.sent.status&&b.b.success("\u5220\u9664\u56fe\u7247\u6210\u529f");case 12:a.setState({fileList:r});case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.getImgList=function(){return a.state.fileList.map((function(e){return e.name}))};var r=[];return e.imgNameList&&e.imgNameList.length>0&&(r=e.imgNameList.map((function(e,t){return{uid:-t,name:e,status:"done",url:"http://localhost:5000/upload"+e}}))),a.state={previewVisible:!1,previewImage:"",fileList:r},a}return Object(o.a)(n,[{key:"render",value:function(){var e=this.state,t=e.previewVisible,n=e.previewImage,a=e.fileList,r=Object(Q.jsxs)("div",{children:[Object(Q.jsx)(me.a,{}),Object(Q.jsx)("div",{className:"ant-upload-text",children:"Upload"})]});return Object(Q.jsxs)("div",{className:"clearfix",children:[Object(Q.jsxs)(Pe.a,{accept:"image/*",action:"/manage/img/upload",name:"image",listType:"picture-card",fileList:a,onPreview:this.handlePreview,onChange:this.handleChange,children:[a.length>=8?null:r," "]}),Object(Q.jsx)(X.a,{visible:t,footer:null,onCancel:this.handleCancel,children:Object(Q.jsx)("img",{alt:"example",style:{width:"100%"},src:n})})]})}}]),n}(r.a.Component),Te=n(102),_e=n(274),Ue=n(275),Re=n.n(Ue),Me=n(276),De=n.n(Me),Ee=(n(501),function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(e){var a;if(Object(i.a)(this,n),(a=t.call(this,e)).onEditorStateChange=function(e){a.setState({editorState:e})},a.getTextContent=function(){var e=a.state.editorState;return Re()(Object(Te.convertToRaw)(e.getCurrentContent()))},a.uploadImageCallBack=function(e){return new Promise((function(t,n){var a=new XMLHttpRequest;a.open("POST","/manage/img/upload");var r=new FormData;r.append("image",e),a.send(r),a.addEventListener("load",(function(){var e=JSON.parse(a.responseText).data.url;t({data:{link:e}})})),a.addEventListener("error",(function(){var e=JSON.parse(a.responseText);n(e)}))}))},e.detail){var r=De()(e.detail),s=Te.ContentState.createFromBlockArray(r.contentBlocks),c=Te.EditorState.createWithContent(s);a.state={editorState:c}}else a.state={editorState:Te.EditorState.createEmpty()};return a}return Object(o.a)(n,[{key:"render",value:function(){var e=this.state.editorState;return Object(Q.jsx)(_e.Editor,{editorState:e,editorStyle:{border:"1px black solid",minHeight:"200px",padding:"0 10px"},onEditorStateChange:this.onEditorStateChange,toolbar:{inline:{inDropdown:!0},list:{inDropdown:!0},textAlign:{inDropdown:!0},link:{inDropdown:!0},history:{inDropdown:!0},image:{uploadCallback:this.uploadImageCallBack,alt:{present:!0,mandatory:!0}}}})}}]),n}(a.Component)),Le=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(e){var a;return Object(i.a)(this,n),(a=t.call(this,e)).state={options:[]},a.onFinish=function(){var e=Object(m.a)(j.a.mark((function e(t){var n,r,s,c,i,o,u,l,d,h,p,m,f,O;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=a.PictureWall.current.getImgList(),r=a.RichTextEditor.current.getTextContent(),s=t.productName,c=t.productDesc,i=t.productPrice,o=t.productCategory,!a.isUpdate){e.next=12;break}return u=a.props.location.state,l=u.currentPageNum,d=u.searchName,h=u.searchType,e.next=7,L(a.product._id,o[0],o[1],s,c,i,r,n);case 7:0===e.sent.status&&b.b.success("\u4fee\u6539\u5546\u54c1\u6210\u529f"),a.props.history.push("/product",{currentPageNum:l,searchName:d,searchType:h}),e.next=17;break;case 12:return p=a.props.location.state,m=p.searchName,f=p.searchType,O=p.total,e.next=15,E(o[0],o[1],s,c,i,r,n);case 15:0===e.sent.status&&(b.b.success("\u6dfb\u52a0\u5546\u54c1\u6210\u529f"),a.props.history.push("/product",{searchName:m,searchType:f,total:O}));case 17:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.validatePrice=function(e,t){return 1*t<0?Promise.reject(new Error("\u4ef7\u683c\u5fc5\u987b\u5927\u4e8e0")):Promise.resolve()},a.initOptions=function(){var e=Object(m.a)(j.a.mark((function e(t){var n,r,s,c,i,o,u;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.map((function(e){return{value:e._id,label:e.name,isLeaf:!1}})),r=Object(Ne.a)(a),s=r.isUpdate,c=r.product,!s){e.next=10;break}if("0"===(i=c.pCategoryId)){e.next=10;break}return e.next=7,F(i);case 7:o=e.sent,u=n.find((function(e){return e.value===i})),0===o.status&&(u.children=o.data.map((function(e){return{label:e.name,value:e._id,isLeaf:!0}})));case 10:a.setState({options:n});case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.loadData=function(){var e=Object(m.a)(j.a.mark((function e(t){var n,r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=t[0]).loading=!0,e.next=4,a.getCategorys(n.value);case 4:(r=e.sent)&&r.length>0?(n.loading=!1,n.children=r.map((function(e){return{label:e.name,value:e._id,isLeaf:!0}}))):(n.loading=!1,n.isLeaf=!0),a.setState({options:Object(Se.a)(a.state.options)});case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.getCategorys=function(){var e=Object(m.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,F(t);case 2:if(0!==(n=e.sent).status){e.next=9;break}if("0"!==t){e.next=8;break}a.initOptions(n.data),e.next=9;break;case 8:return e.abrupt("return",n.data);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.PictureWall=r.a.createRef(),a.RichTextEditor=r.a.createRef(),a}return Object(o.a)(n,[{key:"UNSAFE_componentWillMount",value:function(){this.props.location.state&&this.props.location.state.product?(this.product=this.props.location.state.product,this.isUpdate=!0):(this.product={},this.isUpdate=!1)}},{key:"componentDidMount",value:function(){this.getCategorys("0")}},{key:"render",value:function(){var e=this,t=this.product,n=t.categoryId,a=t.pCategoryId,r=[];a&&r.push(a,n);var s=Object(Q.jsxs)("span",{children:[Object(Q.jsx)(ae,{onClick:function(){return e.props.history.goBack()},children:Object(Q.jsx)(ve.a,{style:{color:"#1DA57A",fontSize:20}})}),"\xa0",Object(Q.jsx)("span",{children:this.isUpdate?"\u4fee\u6539\u5546\u54c1":"\u6dfb\u52a0\u5546\u54c1"})]});return Object(Q.jsx)(he.a,{title:s,children:Object(Q.jsxs)(f.a,{labelCol:{span:2},wrapperCol:{span:8},onFinish:this.onFinish,children:[Object(Q.jsx)(f.a.Item,{label:"\u5546\u54c1\u540d\u79f0",name:"productName",initialValue:t.name,rules:[{required:!0,whitespace:!0,message:"\u5fc5\u987b\u8f93\u5165\u5546\u54c1\u540d\u79f0"}],children:Object(Q.jsx)(O.a,{placeholder:"\u8bf7\u8f93\u5165\u5546\u54c1\u540d\u79f0"})}),Object(Q.jsx)(f.a.Item,{label:"\u5546\u54c1\u63cf\u8ff0",name:"productDesc",initialValue:t.desc,rules:[{required:!0,whitespace:!0,message:"\u5fc5\u987b\u8f93\u5165\u5546\u54c1\u63cf\u8ff0"}],children:Object(Q.jsx)(O.a.TextArea,{placeholder:"\u8bf7\u8f93\u5165\u5546\u54c1\u63cf\u8ff0",autoSize:{minRows:2,maxRows:6},showCount:!0})}),Object(Q.jsx)(f.a.Item,{label:"\u5546\u54c1\u4ef7\u683c",name:"productPrice",initialValue:t.price,rules:this.isUpdate?[{validator:this.validatePrice}]:[{required:!0,whitespace:!0,message:"\u5fc5\u987b\u8f93\u5165\u5546\u54c1\u4ef7\u683c"},{validator:this.validatePrice}],children:Object(Q.jsx)(O.a,{type:"number",placeholder:"\u8bf7\u8f93\u5165\u5546\u54c1\u4ef7\u683c",addonAfter:"\u5143"})}),Object(Q.jsx)(f.a.Item,{label:"\u5546\u54c1\u5206\u7c7b",name:"productCategory",initialValue:r,children:Object(Q.jsx)(Ie.a,{placeholder:"\u6307\u5b9a\u5546\u54c1\u5206\u7c7b",options:this.state.options,loadData:this.loadData})}),Object(Q.jsx)(f.a.Item,{label:"\u5546\u54c1\u56fe\u7247",children:Object(Q.jsx)(Ae,{ref:this.PictureWall,imgNameList:this.product.imgs})}),Object(Q.jsx)(f.a.Item,{label:"\u5546\u54c1\u8be6\u60c5",labelCol:{span:2},wrapperCol:{span:20},children:Object(Q.jsx)(Ee,{ref:this.RichTextEditor,detail:this.product.detail})}),Object(Q.jsx)(f.a.Item,{wrapperCol:{span:8,offset:4},children:Object(Q.jsx)(x.a,{type:"primary",htmlType:"submit",children:"\u63d0\u4ea4"})})]})})}}]),n}(a.Component),Ve=(n(502),function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"render",value:function(){return Object(Q.jsxs)(h.d,{children:[Object(Q.jsx)(h.b,{path:"/product",component:ge,exact:!0}),Object(Q.jsx)(h.b,{path:"/product/addupdate",component:Le}),Object(Q.jsx)(h.b,{path:"/product/detail",component:Ce}),Object(Q.jsx)(h.a,{to:"/product"})]})}}]),n}(a.Component)),Be=f.a.Item,Ke=be.a.Option,ze=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(e){var a;return Object(i.a)(this,n),(a=t.call(this,e)).UserForm=r.a.createRef(),a}return Object(o.a)(n,[{key:"shouldComponentUpdate",value:function(e){var t=e.user,n=t.username,a=t.email,r=t.phone,s=t.role_id;return this.UserForm.current.setFieldsValue({username:n,email:a,phone:r,role_id:s}),!0}},{key:"componentDidMount",value:function(){(0,this.props.setForm)(this.UserForm.current)}},{key:"render",value:function(){var e=this.props,t=e.roles,n=e.user,a=n.username,r=n.email,s=n.phone,c=n.role_id;return Object(Q.jsxs)(f.a,Object(ne.a)(Object(ne.a)({},{labelCol:{span:4},wrapperCol:{span:15}}),{},{ref:this.UserForm,initialValues:{username:a,email:r,phone:s,role_id:c},children:[Object(Q.jsx)(Be,{label:"\u7528\u6237\u540d",name:"username",children:Object(Q.jsx)(O.a,{placeholder:"\u8bf7\u8f93\u5165\u7528\u6237\u540d"})}),n._id?null:Object(Q.jsx)(Be,{label:"\u5bc6\u7801",name:"password",children:Object(Q.jsx)(O.a.Password,{placeholder:"\u8bf7\u8f93\u5165\u5bc6\u7801",visibilityToggle:!1})}),Object(Q.jsx)(Be,{label:"\u624b\u673a\u53f7",name:"phone",children:Object(Q.jsx)(O.a,{placeholder:"\u8bf7\u8f93\u5165\u624b\u673a\u53f7"})}),Object(Q.jsx)(Be,{label:"\u90ae\u7bb1",name:"email",children:Object(Q.jsx)(O.a,{placeholder:"\u8bf7\u8f93\u5165\u90ae\u7bb1"})}),Object(Q.jsx)(Be,{label:"\u89d2\u8272",name:"role_id",children:Object(Q.jsx)(be.a,{children:t.map((function(e){return Object(Q.jsx)(Ke,{value:e._id,children:e.name},e._id)}))})})]}))}}]),n}(a.Component),We=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(e){var a;return Object(i.a)(this,n),(a=t.call(this,e)).getUsers=Object(m.a)(j.a.mark((function e(){var t;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S("/manage/user/list");case 2:0===(t=e.sent).status&&(a.setState({users:t.data.users,roles:t.data.roles}),a.initRolesIdToName());case 4:case"end":return e.stop()}}),e)}))),a.initColumns=function(){a.columns=[{title:"\u7528\u6237\u540d",dataIndex:"username"},{title:"\u90ae\u7bb1",dataIndex:"email"},{title:"\u7535\u8bdd",dataIndex:"phone"},{title:"\u6ce8\u518c\u65f6\u95f4",dataIndex:"create_time",render:function(e){return ee(e)}},{title:"\u6240\u5c5e\u89d2\u8272",dataIndex:"role_id",render:function(e){return a.state.roles.find((function(t){return t._id===e})).name}},{title:"\u64cd\u4f5c",render:function(e){return Object(Q.jsxs)("span",{children:[Object(Q.jsx)(ae,{onClick:function(){return a.showUpdate(e)},children:"\u4fee\u6539"}),Object(Q.jsx)(ae,{onClick:function(){return a.deleteUser(e)},children:"\u5220\u9664"})]})}}]},a.deleteUser=function(e){X.a.confirm({title:"Confirm",icon:Object(Q.jsx)(Y.a,{}),content:"\u786e\u5b9a\u5220\u9664".concat(e.username,"\u5417"),okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",onOk:function(){var t=Object(m.a)(j.a.mark((function t(){return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,S("/manage/user/delete",{userId:e._id},"POST");case 2:0===t.sent.status&&b.b.success("\u6210\u529f\u5220\u9664".concat(e.username)),a.getUsers();case 5:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()})},a.showAdd=function(){a.user={},a.setState({isShow:!0})},a.showUpdate=function(e){a.user=e,a.setState({isShow:!0})},a.addOrUpdateUser=Object(m.a)(j.a.mark((function e(){var t,n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!a.user._id){e.next=9;break}return(t=a.form.getFieldsValue(!0))._id=a.user._id,e.next=5,z(t);case 5:0===e.sent.status&&b.b.success("\u4fee\u6539\u7528\u6237\u6210\u529f"),e.next=14;break;case 9:return n=a.form.getFieldsValue(!0),e.next=12,K(n);case 12:0===e.sent.status&&b.b.success("\u6dfb\u52a0\u7528\u6237\u6210\u529f");case 14:a.getUsers(),a.setState({isShow:!1});case 16:case"end":return e.stop()}}),e)}))),a.initRolesIdToName=function(){a.rolesIdToName=a.state.roles.reduce((function(e,t){return e[t._id]=t.name,e}),{})},a.state={users:[],roles:[],isShow:!1},a}return Object(o.a)(n,[{key:"componentDidMount",value:function(){this.getUsers(),this.initColumns()}},{key:"render",value:function(){var e=this,t=this.state,n=t.users,a=t.isShow,r=t.roles,s=this.user||{},c=Object(Q.jsx)(x.a,{type:"primary",onClick:this.showAdd,children:"\u521b\u5efa\u7528\u6237"});return Object(Q.jsxs)(he.a,{title:c,children:[Object(Q.jsx)(pe.a,{bordere:!0,rowKey:"_id",dataSource:n,columns:this.columns,pagination:{defaultPageSize:3}}),Object(Q.jsx)(X.a,{title:s._id?"\u4fee\u6539\u7528\u6237":"\u521b\u5efa\u7528\u6237",visible:a,onOk:this.addOrUpdateUser,onCancel:function(){e.setState({isShow:!1})},children:Object(Q.jsx)(ze,{roles:r,user:Object(ne.a)({},this.user),setForm:function(t){return e.form=t}})})]})}}]),n}(a.Component),qe=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(e){var a;return Object(i.a)(this,n),(a=t.call(this,e)).addForm=r.a.createRef(),a}return Object(o.a)(n,[{key:"componentDidMount",value:function(){this.props.setForm(this.addForm.current)}},{key:"render",value:function(){return Object(Q.jsx)(f.a,{ref:this.addForm,children:Object(Q.jsx)(f.a.Item,{label:"\u89d2\u8272\u540d\u79f0",wrapperCol:{span:16},name:"roleName",rules:[{required:!0,whitespace:!0,message:"\u5fc5\u987b\u8f93\u5165\u89d2\u8272\u540d\u79f0"}],children:Object(Q.jsx)(O.a,{placeholder:"\u8bf7\u8f93\u5165\u89d2\u8272\u540d\u79f0"})})})}}]),n}(a.Component),He=n(519),Je=[{title:"\u5e73\u53f0\u6743\u9650",key:"00",children:[]}];Je[0].children=function e(t){return t.map((function(t){return t.children?{title:t.title,key:t.key,children:e(t.children)}:{title:t.title,key:t.key}}))}(te);var Ge=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(e){var a;Object(i.a)(this,n),(a=t.call(this,e)).onCheck=function(e){a.setState({checkedKeys:e})},a.getMenus=function(){return a.state.checkedKeys};var r=e.role;return a.state={checkedKeys:r.menus},a}return Object(o.a)(n,[{key:"shouldComponentUpdate",value:function(e){var t=e.role;return this.state.checkedKeys=t.menus,!0}},{key:"render",value:function(){var e=this.props.role,t=this.state.checkedKeys;return Object(Q.jsxs)("div",{children:[Object(Q.jsx)(f.a.Item,{label:"\u89d2\u8272\u540d\u79f0",labelCol:{span:4},wrapperCol:{span:15},children:Object(Q.jsx)(O.a,{disabled:!0,value:e.name})}),Object(Q.jsx)(He.a,{checkable:!0,defaultExpandAll:!0,checkedKeys:t,treeData:Je,onCheck:this.onCheck})]})}}]),n}(a.Component),Qe=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(e){var a;return Object(i.a)(this,n),(a=t.call(this,e)).showAddModal=function(){a.setState({showAdd:!a.state.showAdd})},a.addRole=Object(m.a)(j.a.mark((function e(){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a.addForm.validateFields().then(function(){var e=Object(m.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.roleName,e.next=3,V(n);case 3:0===e.sent.status&&(a.getRoles(),b.b.success("\u6dfb\u52a0\u89d2\u8272\u6210\u529f")),a.addForm.resetFields(),a.setState({showAdd:!1});case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:case"end":return e.stop()}}),e)}))),a.handleCancel=function(){a.addForm.resetFields(),a.setState({showAdd:!1})},a.showSetAuthModal=function(){a.setState({showSetAuth:!0})},a.setAuth=Object(m.a)(j.a.mark((function e(){var t,n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.state.selectedRole,n=a.setAuthForm.current.getMenus(),t.menus=n,t.auth_name=q.user.username,e.next=6,B(t);case 6:0===e.sent.status&&(b.b.success("\u66f4\u65b0\u89d2\u8272\u6210\u529f"),q.user.role_id===t._id?(G.removeUser(),q.user={},a.props.history.replace("/login")):a.setState({showSetAuth:!1,role:Object(Se.a)(a.state.roles)}));case 8:case"end":return e.stop()}}),e)}))),a.onRow=function(e){return{onClick:function(t){a.setState({selectedRole:e})}}},a.getRoles=Object(m.a)(j.a.mark((function e(){var t;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S("/manage/role/list");case 2:0===(t=e.sent).status&&a.setState({roles:t.data});case 4:case"end":return e.stop()}}),e)}))),a.state={showAdd:!1,showSetAuth:!1,roles:[],selectedRole:{}},a.columns=[{title:"\u89d2\u8272\u540d\u79f0",dataIndex:"name"},{title:"\u521b\u5efa\u65f6\u95f4",dataIndex:"create_time",render:function(e){return ee(e)}},{title:"\u6388\u6743\u65f6\u95f4",dataIndex:"auth_time",render:function(e){return ee(e)}},{title:"\u6388\u6743\u4eba",dataIndex:"auth_name"}],a.setAuthForm=r.a.createRef(),a}return Object(o.a)(n,[{key:"componentDidMount",value:function(){this.getRoles()}},{key:"render",value:function(){var e=this,t=this.state,n=t.roles,a=t.selectedRole,r=t.showAdd,s=t.showSetAuth,c=Object(Q.jsxs)("span",{children:[Object(Q.jsx)(x.a,{type:"primary",style:{marginRight:10},onClick:this.showAddModal,children:"\u521b\u5efa\u89d2\u8272"}),Object(Q.jsx)(x.a,{type:"primary",disabled:!a._id,onClick:this.showSetAuthModal,children:"\u8bbe\u7f6e\u89d2\u8272\u6743\u9650"})]});return Object(Q.jsxs)(he.a,{title:c,children:[Object(Q.jsx)(pe.a,{onRow:this.onRow,bordere:!0,rowKey:"_id",rowSelection:{type:"radio",selectedRowKeys:[a._id],onSelect:function(t){e.setState({selectedRole:t})}},dataSource:n,columns:this.columns,pagination:{defaultPageSize:3}}),Object(Q.jsx)(X.a,{title:"\u6dfb\u52a0\u89d2\u8272",visible:r,onOk:this.addRole,onCancel:this.handleCancel,children:Object(Q.jsx)(qe,{setForm:function(t){return e.addForm=t}})}),Object(Q.jsx)(X.a,{title:"\u8bbe\u7f6e\u6743\u9650",visible:s,onOk:this.setAuth,onCancel:function(){e.setState({showSetAuth:!1})},children:Object(Q.jsx)(Ge,{role:a,ref:this.setAuthForm})})]})}}]),n}(a.Component),Ze=n(120),$e=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(i.a)(this,n);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).state={sales:[20,20,36,10,10,20],stores:[40,15,50,33,10,20]},e.update=function(){e.setState((function(e){return{sales:e.sales.map((function(e){return e+1})),stores:e.stores.map((function(e){return e-1}))}}))},e.getOptions=function(){return{title:{text:"ECharts \u5165\u95e8\u793a\u4f8b"},tooltip:{},legend:{data:["\u9500\u91cf","\u5e93\u5b58"]},xAxis:{data:["\u886c\u886b","\u7f8a\u6bdb\u886b","\u96ea\u7eba\u886b","\u88e4\u5b50","\u9ad8\u8ddf\u978b","\u889c\u5b50"]},yAxis:{},series:[{name:"\u9500\u91cf",type:"bar",data:e.state.sales,showBackground:!0,backgroundStyle:{color:"rgba(180, 180, 180, 0.2)"}},{name:"\u5e93\u5b58",type:"bar",data:e.state.stores,color:"red",showBackground:!0,backgroundStyle:{color:"rgba(180, 180, 180, 0.2)"}}]}},e}return Object(o.a)(n,[{key:"render",value:function(){return Object(Q.jsxs)("div",{children:[Object(Q.jsx)(he.a,{children:Object(Q.jsx)(x.a,{type:"primary",onClick:this.update,children:"\u66f4\u65b0"})}),Object(Q.jsx)(he.a,{title:"\u67f1\u72b6\u56fe\u4e00",children:Object(Q.jsx)(Ze.a,{option:this.getOptions()})})]})}}]),n}(a.Component),Xe=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(i.a)(this,n);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).state={sales:[20,20,36,10,10,20],stores:[40,15,50,33,10,20]},e.update=function(){e.setState((function(e){return{sales:e.sales.map((function(e){return e+1})),stores:e.stores.map((function(e){return e-1}))}}))},e.getOptions=function(){return{title:{text:"ECharts \u5165\u95e8\u793a\u4f8b"},tooltip:{},legend:{data:["\u9500\u91cf","\u5e93\u5b58"]},xAxis:{data:["\u886c\u886b","\u7f8a\u6bdb\u886b","\u96ea\u7eba\u886b","\u88e4\u5b50","\u9ad8\u8ddf\u978b","\u889c\u5b50"]},yAxis:{},series:[{name:"\u9500\u91cf",type:"line",data:e.state.sales,showBackground:!0,backgroundStyle:{color:"rgba(180, 180, 180, 0.2)"}},{name:"\u5e93\u5b58",type:"line",data:e.state.stores,color:"red",showBackground:!0,backgroundStyle:{color:"rgba(180, 180, 180, 0.2)"}}]}},e}return Object(o.a)(n,[{key:"render",value:function(){return Object(Q.jsxs)("div",{children:[Object(Q.jsx)(he.a,{children:Object(Q.jsx)(x.a,{type:"primary",onClick:this.update,children:"\u66f4\u65b0"})}),Object(Q.jsx)(he.a,{title:"\u67f1\u72b6\u56fe\u4e00",children:Object(Q.jsx)(Ze.a,{option:this.getOptions()})})]})}}]),n}(a.Component),Ye=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(i.a)(this,n);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).state={sales:[20,20,36,10,10,20],stores:[40,15,50,33,10,20]},e.update=function(){e.setState((function(e){return{sales:e.sales.map((function(e){return e+1})),stores:e.stores.map((function(e){return e-1}))}}))},e.getOptions=function(){return{title:{text:"ECharts \u5165\u95e8\u793a\u4f8b"},tooltip:{},legend:{data:["\u9500\u91cf","\u5e93\u5b58"]},xAxis:{data:["\u886c\u886b","\u7f8a\u6bdb\u886b","\u96ea\u7eba\u886b","\u88e4\u5b50","\u9ad8\u8ddf\u978b","\u889c\u5b50"]},yAxis:{},series:[{name:"\u9500\u91cf",type:"pie",data:e.state.sales,showBackground:!0,backgroundStyle:{color:"rgba(180, 180, 180, 0.2)"}},{name:"\u5e93\u5b58",type:"pie",data:e.state.stores,color:"red",showBackground:!0,backgroundStyle:{color:"rgba(180, 180, 180, 0.2)"}}]}},e}return Object(o.a)(n,[{key:"render",value:function(){return Object(Q.jsxs)("div",{children:[Object(Q.jsx)(he.a,{children:Object(Q.jsx)(x.a,{type:"primary",onClick:this.update,children:"\u66f4\u65b0"})}),Object(Q.jsx)(he.a,{title:"\u67f1\u72b6\u56fe\u4e00",children:Object(Q.jsx)(Ze.a,{option:this.getOptions()})})]})}}]),n}(a.Component),et=n(126),tt=n(69),nt=(n(508),function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"render",value:function(){var e=this;return Object(Q.jsxs)(et.a,{className:"not-found",children:[Object(Q.jsx)(tt.a,{span:12,className:"left"}),Object(Q.jsxs)(tt.a,{span:12,className:"right",children:[Object(Q.jsx)("h1",{children:"404"}),Object(Q.jsx)("h2",{children:"\u62b1\u6b49\uff0c\u4f60\u8bbf\u95ee\u7684\u9875\u9762\u4e0d\u5b58\u5728"}),Object(Q.jsx)("div",{children:Object(Q.jsx)(x.a,{type:"primary",onClick:function(){return e.props.history.replace("/home")},children:"\u56de\u5230\u9996\u9875"})})]})]})}}]),n}(a.Component)),at=$.a.Footer,rt=$.a.Sider,st=$.a.Content,ct=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"render",value:function(){var e=q.user;return e&&e._id?Object(Q.jsxs)($.a,{style:{minHeight:"100%"},children:[Object(Q.jsx)(rt,{children:Object(Q.jsx)(le,{})}),Object(Q.jsxs)($.a,{children:[Object(Q.jsx)(se,{children:"Header"}),Object(Q.jsx)(st,{style:{background:"#fff",margin:"20px"},children:Object(Q.jsxs)(h.d,{children:[Object(Q.jsx)(h.a,{exact:!0,from:"/",to:"/home"}),Object(Q.jsx)(h.b,{path:"/home",component:de}),Object(Q.jsx)(h.b,{path:"/category",component:xe}),Object(Q.jsx)(h.b,{path:"/product",component:Ve}),Object(Q.jsx)(h.b,{path:"/role",component:Qe}),Object(Q.jsx)(h.b,{path:"/user",component:We}),Object(Q.jsx)(h.b,{path:"/charts/bar",component:$e}),Object(Q.jsx)(h.b,{path:"/charts/line",component:Xe}),Object(Q.jsx)(h.b,{path:"/charts/pie",component:Ye}),Object(Q.jsx)(h.b,{component:nt})]})}),Object(Q.jsx)(at,{style:{textAlign:"center",color:"#AAA"},children:"\u63a8\u8350\u4f7f\u7528\u8c37\u6b4c\u6d4f\u89c8\u5668,\u53ef\u4ee5\u83b7\u5f97\u6700\u4f73\u9875\u9762\u64cd\u4f5c\u4f53\u9a8c"})]})]}):Object(Q.jsx)(h.a,{to:"/login"})}}]),n}(a.Component),it=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"render",value:function(){return console.log("app"),Object(Q.jsx)(d.a,{children:Object(Q.jsxs)(h.d,{children:[Object(Q.jsx)(h.b,{path:"/login",component:Z}),Object(Q.jsx)(h.b,{path:"/",component:ct})]})})}}]),n}(a.Component);q.user=G.getUser(),console.log("index"),c.a.render(Object(Q.jsx)(it,{}),document.getElementById("root"))}},[[509,1,2]]]);
//# sourceMappingURL=main.3bdaee5d.chunk.js.map